<div class="body_index2">
    <div class="header_index2">
        <div class="headr_logo">
            <img src="/images/logo.png" />
            <h2>Dino Account</h2>
        </div>
        <div class="header_account">
            <img src="{{user.image}}" />
            <p class="mt-3">{{user.username}}</p>
            <a href="/log-out"><button>Log out</button></a>
        </div>
    </div>

    <!-- Tab link -->
    <ul class="menu-list">
        <a onclick="redicrectHome('{{user._id}}')" class="tablinks" style="color: red;
            border-bottom: 2px solid red;">
            <li>Home</li>
        </a>
        <a href="/xep-hang" class="tablinks">
            <li>Rank</li>
        </a>
        <a href="/thu-vien" class="tablinks">
            <li>Library</li>
        </a>
        {{!-- <a href="/ho-tro" class="tablinks">
            <li>Hỗ trợ</li>
        </a> --}}
        <a href="/nap-the" class="tablinks">
            <li>Recharge</li>
        </a>
        <a href="/images/game/DinoAdventure.exe" class="tablinks">
            <li>Download</li>
        </a>
    </ul>

    <!-- Tab content -->
    <div id="trang_chu" class="tabcontent">
        {{#if checkGmail}}
        <div class="alert">
            <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
            <strong>Notify: </strong> {{checkGmail}}!
        </div>
        {{/if}}
        <div class="tab_home">
            <div class="userinfo">
                <div class="info">
                    <img src="{{user.image}}" />
                    <div class="info-list">
                        <h5>{{user.username}}</h5>
                        <h4>${{user.price}}</h4>
                        <p>What are you thinking?</p>
                    </div>
                </div>
                <hr>
                <div class="info2">
                    <div class="info2-item">
                        <i class="material-icons">&#xe0be;</i>
                        <a type="button" onclick="google('{{this._id}}')">{{user.email}}</a>
                    </div>
                    <div class="info2-item">
                        <i class="material-icons"> &#xe899;</i>
                        <a type="button" onclick="checkPassword('{{user._id}}')">Change the password</a>
                    </div>
                    <div class="info2-item">
                        <i class="fas fa-cart-arrow-down"></i>
                        <a type="button" onclick="history('receipt')">Transaction history</a>
                    </div>
                    <div class="info2-item">
                        <i class="fas fa-history"></i>
                        <a type="button" onclick="history('action')">Operation history</a>
                    </div>
                </div>
            </div>
            <div class="user-bag">
                <div class="title-bag">
                    <button id="defaultOpen" class="tab-product" onclick="openBag(event, 'character')">Character</button>
                    <button class="tab-product" onclick="openBag(event, 'weapon')">Weapons</button>
                    <button class="tab-product" onclick="openBag(event, 'achievement')">Achievement</button>
                </div>
                <div class="all-bag">
                    <div id="character" class="product-bag">
                        <div class="br-item">
                            {{#each characters}}
                            <div class="item-monter" type="button" data-bs-toggle="modal"
                                data-bs-target="#character{{this._id}}">
                                <img src="{{this.image}}">
                            </div>
                            {{/each}}
                        </div>
                    </div>

                    <div id="weapon" class="product-bag">
                        <div class="br-item">
                            {{#each weapons}}
                            <div class="item-monter" type="button" data-bs-toggle="modal"
                                data-bs-target="#weapon{{this._id}}">
                                <img src="{{this.image}}">
                            </div>
                            {{/each}}
                        </div>
                    </div>

                    <div id="achievement" class="product-bag">
                        {{#each myachievement}}
                            {{!-- <div class="item-achievement" type="button" data-bs-toggle="modal"
                                data-bs-target="#achievement{{this._id}}"> --}}
                            <div class="item-achievement"> 
                                <div class="title-achievement">
                                    <h3>{{this.name}}</h3>
                                    <p>{{this.description}}</p>
                                </div>
                                <div class="reward-achievement">
                                    {{#if this.achieved}}
                                    <p>{{this.date}}</p>
                                    {{else}}
                                    <p><img src="images/coin.png" style="width: 25px; height: 25px;"></p>
                                    <p>x{{this.reward}}</p>
                                    {{/if}}
                                </div>
                            </div>
                            {{/each}}
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>


{{#each characters}}
<div style="position: absolute; top: 25%;" class="modal" id="character{{this._id}}">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4>Name: {{this.name}}</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body" style="display: flex; flex-direction: row;">
                <div style=" height: 123px; border: 2px solid rgb(255, 162, 0); border-radius: 5px;">
                    <img style="height: 120px; width: 90px; object-fit: cover; border-radius: 5px;" src="{{this.image}}">
                </div>
                <div style="display: flex; flex-direction: column; justify-content: space-around; 
                border: 2px solid rgb(255, 170, 0); margin-left: 5px; border-radius: 10px; padding: 3px;" >
                    <h5>Price:{{this.price}}</h5>
                    <h5>Open request point:{{this.point}}</h5>
                    <p>Describe: {{this.describes}}</p>
                </div>

            </div>
        </div>
    </div>
</div>
{{/each}}
{{#each weapons}}
<div class="modal" id="weapon{{this._id}}">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4>Name: {{this.name}}</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body" style="display: flex; flex-direction: row;">
                <div style=" height: 123px;  border: 2px solid rgb(255, 162, 0); border-radius: 5px;">
                    <img style="height: 120px; width: 90px; border-radius: 5px;" src="{{this.image}}">
                </div>
                <div style="display: flex; flex-direction: column; justify-content: space-around; 
                border: 2px solid rgb(255, 170, 0); margin-left: 5px; border-radius: 10px; padding: 3px;">
                    <h5>Open request point:{{this.point}}</h5>
                    <p>Describe: {{this.describes}}</p>
                </div>

            </div>
        </div>
    </div>
</div>
{{/each}}

<script>


    document.getElementById("defaultOpen").click();
    function openBag(evt, product) {
        var i, tabcontent, tablinks;

        tabcontent = document.getElementsByClassName("product-bag");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }

        tablinks = document.getElementsByClassName("tab-product");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }

        document.getElementById(product).style.display = "block";
        evt.currentTarget.className += " active";
    }

    const google = () => {
        window.location.href = `/auth/google`
    }

    const updatePassword = (id) => {
        window.location.href = `/user/${id}/forgot-password`
    }

    const checkPassword = (id) => {
        window.location.href = `/user/check-password`
    }
    const redicrectHome = (_id) => {
        window.location.href = `user`
    }

    const history = (loai) => {
        window.location.href = `/history/${loai}`
    }

</script>


<style>
    .alert {
        padding: 20px;
        background-color: #ce746d;
        color: white;
    }
    .closebtn {
        margin-left: 15px;
        color: white;
        font-weight: bold;
        float: right;
        font-size: 22px;
        line-height: 20px;
        cursor: pointer;
        transition: 0.3s;
    }
    .closebtn:hover {
        color: black;
    }
</style>